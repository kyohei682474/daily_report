# 2024/11/21の日報
## 取り組んだ課題一覧
* タイピング練習
* Ruby on Rails5速習実践ガイドをやる
## わかったこと
* 直接値を入力することはコマンドラインインジェクションによって攻撃される可能性があるので注意。
  *  安易にプリケーションを作成風にgitのコマンドラインを直接入力すべきではない
  *  kernel.#systemやkernel.#spawnメソッドOpen3モジュールなどを使用することで解決できるが、これにも直接的な文字列を入力しては攻撃対象になってしまう。
* content security policyはXSSやパケット盗聴といった特定の攻撃をブラウザ側で軽減するための仕組み
  *  webページのコンテンツの取得元や取得方法のポリシーをwebサーバからブラウザに使えることができる
  *  CSPを設定するにはWebサーバーからHTTPヘッダーにcontent-security-policyを組み込む。
  *  config/initializers/content_security_policy.rbに記述する
*  production環境はアセットパイプラインの機能をフルに活用して1つのjavascriptファイル1つのCSSファイルを生成しておそれを配信するというのが基本
  *  development環境とは異なりアセットの結合と最小化が行われている。
*  CSSを読み込むにはstylesheet_link_tag,Javascriptを読み込むにはjavascript_include_tagというヘルパーメソッドを使用する。
*  application.cssファイルやapplication.jsといったマニュフェストファイルは個別のcssファイルやjsを連結させて結合させたファイルでこれを最終的にアプリを使用する上で都合の良い状態にするためのパイプライン処理を行うのがアセットパイプライン
*  マニュフェストファイルでは//=という特別な記法を使用して、アセットパイプラインに指示を伝えるための特別な行として扱う。
  *  require_treeでは指定されたディレクトリ配下の全ファイルの内容を結合して記述した位置に取り込む。
*  マニュフェストで指定するファイルはアセット探索パスの設定を元に引き当てられる。
  *  lib/assets,app/assetsなど
  *  探索パスを自ら設定する際はconfig/initializers/assets.rbの中に記述する。
* SassはCSSを拡張して使用しやすくしたメタ言語
*  config.assets.quiet = trueはログが大量になるのでこれを抑制することで開発環境の視認性を高めることができる。
  * 初期状態ではdevelopmentのみでtrueになる。
* config.assets.compile = falseとすることでプリコンパイルすみのアセットが存在しない時に動的なコンパイルを行わない。
  * プリコンパイルとはソースコードを加工してコンパイルできる状態にする処理。
  * このフラグがtrueになるとプリコンパイルすることなしに動作を確認することができるので開発に便利である。
* production環境とは本番環境のこと。
  * リクエストを高速に処理できるように、あらかじめアセットパイプラインを実行しておき静的ファイルを生成する。生成済みファイルのみリクエスト際に配信する。
* YarnはJavascriptのパッケージマネージャー。
* config.content_security_policy_report_only = trueとすることでCSPをレポートモードで動作させる。
  * レポートモードは違反が検出されてもコンテンツの読み込みは中止されず、ブラウザに警告文が表示される。
  * 違反が発生した場合はレポートURLに記載される。
  * CSPはXSSやパケット登頂といった特定攻撃をブラウザ側で軽減する仕組み。
* railsプリケーションのパフォーマンスを高めるには静的ファイルの対応を他に任せて、動的なファイルのコンテンツ配信に専念させることが重要。
  * 静的ファイル配信機能をON/OFFする設定が存在していてProduction環境では基本的にOFFになっている。
* bin/rails db：createコマンドはデータベース設定ファイルの設定内容に従って動作する(config/database.yml)
* 本番環境用のデータベースを作成する際にはpostgresqlにtaskleafというユーザーを追加してデータベースに接続する際に使用するパスワードを環境変数で取得できるようにする。
* createuser -d -P taskleafはpostgresqlで新しいユーザーを作成するツール
  * -dはデータベース作成権限を付与する。
  * -Pはパスワード設定を促す。
* export TASKLEAF_DATABASE_PASSWORD=passwordとすることで設定したパスワードを環境変数TASKLEAF_DATABASE_PASSWORDにセットし、database.ymlから取得できるようにした。
* 本番環境用のデータベースを指定してデータベースを作成して、マイグレートを行うためにRAILS_ENV=production bin/rails  db:create db:migrateとする
* 本番環境モードでアプリケーションを利用するためには本番環境用の秘密情報を暗号化したり、復号するための秘密鍵が必要となる。
  * master.keyに記述されているが暗号化されている。
* 本番環境モードでサーバーを起動するためには--enviroment=productionとを追加してサーバーを起動する。
* 復号化された内容を閲覧するにはrails credentials:showというコマンドを利用する。                              
## 感じたこと
* エラー文章やログで表示されていることをもっと丁寧に読み解くことで多くのことがわかるし、エラーにも概ね対応することができる。
## 合計時間  
Today: 3.0h<br>
Total: 921.25h
